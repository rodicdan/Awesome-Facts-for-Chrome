// Generated by CoffeeScript 1.3.3
(function(){var e,t,n,r;e=!1,t=function(t){if(e)return console.log(t)},r=function(){var e,n;return e=["navbar.navbar-fixed-top","#blueBar.fixed_elem","#onegoogbar","#gb","#mngb",".topbar .global-nav","#navBar.fixed"],t("document ready called"),n=e.join(", "),$(n).length>0?!0:!1},chrome.extension.sendRequest({action:"isEnabled"},function(e){if(e.value===!0)return n.showFact()}),chrome.extension.onRequest.addListener(function(e,t,r){if(e.action==="pluginChanged")return e.value===!0?n.showFact():n.hideFact()}),n={shareURL:"http://simple-planet-5852.herokuapp.com/share",hasFact:function(){return $("#draco-interesting-facts123").length>0},createNewFact:function(e){var n;return n=$('<table id="draco-interesting-facts123">\n<tr>\n  <td id="draco-interesting-facts-share">\n    <iframe src=""></iframe>\n  </td>\n  <td id="draco-interesting-facts-fact123">\n  </td>\n  <td id="draco-interesting-facts-close123">\n    &times;\n  </td>\n</tr>\n</table>'),t("fact content: "+e.content),n.find("#draco-interesting-facts-fact123").html(e.content),n.find("#draco-interesting-facts-share iframe").attr("src",""+this.shareURL+"/"+e.id),window.addEventListener("message",this.handleShareMessage,!1),n.find("#draco-interesting-facts-close123").click(function(){return n.remove()}),$("html:first").prepend(n),n.find("#draco-interesting-facts-share").tooltip({title:"Share Fact",placement:"right"}),n},showFact:function(){var e=this;return this.hasFact()?$("#draco-interesting-facts123").show():chrome.extension.sendRequest({action:"getFact"},function(t){if(r())return;return e.createNewFact(t.value)})},hideFact:function(){return $("#draco-interesting-facts123").hide()},handleShareMessage:function(e){var n;t(e),n=$("#draco-interesting-facts-share iframe").contentWindow;if(e.source!==n)return;if(e.data==="Awesome Fact Shared")return t("shared success"),$("#draco-interesting-facts-share").addClass("disabled").tooltip("disable"),noty({text:"Current Fact Shared :)",layout:"topLeft",type:"success",theme:"noty_theme_facebook"});if(e.data==="Awesome Fact Failed")return t("shared failed"),this.noty({text:"Sharing Failed :(",layout:"topLeft",type:"error",theme:"noty_theme_facebook"})}},$(function(){if(r())return $("#draco-interesting-facts123").remove()})}).call(this);